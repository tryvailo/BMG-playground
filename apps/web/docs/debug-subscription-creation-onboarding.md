# –û—Ç–ª–∞–¥–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –ø—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–ª–∞–Ω –≤—ã–±—Ä–∞–Ω –Ω–∞ —à–∞–≥–µ Pricing.

## –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `setOnboardingData({ ...onboardingData, planId, interval })`, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–µ —Å –∑–∞–º—ã–∫–∞–Ω–∏–µ–º (closure) - —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `onboardingData` –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
```typescript
// –ë—ã–ª–æ:
setOnboardingData({ ...onboardingData, planId, interval });

// –°—Ç–∞–ª–æ:
setOnboardingData(prev => ({ ...prev, planId, interval }));
```

### 2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –≤ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Å—Ç–∞—Ö:
- –í `StepPricing` –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –ø–ª–∞–Ω–∞
- –í `onboarding/page.tsx` –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞
- –í `onboarding/page.tsx` –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞
- –í API endpoint –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### 1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/onboarding` –∏–ª–∏ `/ukr/onboarding`
2. –ü—Ä–æ–π–¥–∏—Ç–µ –≤—Å–µ —à–∞–≥–∏
3. **–ù–∞ —à–∞–≥–µ Pricing –≤—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞–Ω** (Starter –∏–ª–∏ Growth)
4. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console):

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```
[StepPricing] Calling onPlanSelect with: { planId: 'starter', interval: 'month' }
[Onboarding] Plan selected: { planId: 'starter', interval: 'month', currentData: {...} }
[Onboarding] Sending project creation request: { planId: 'starter', ... }
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ (—Ç–µ—Ä–º–∏–Ω–∞–ª, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `pnpm dev`):

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```
[CreateProject] Received request data: { planId: 'starter', region: 'UA', ... }
[CreateProject] Checking subscription creation: { planId: 'starter', ... }
[CreateProject] Creating subscription with data: { ... }
[CreateProject] ‚úÖ Created pending subscription: { userId: '...', subscriptionId: '...', ... }
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–æ–∑–¥–∞–Ω–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É
SELECT 
  s.id,
  s.plan_id,
  s.plan_name,
  s.payment_status,
  a.email,
  a.name,
  s.created_at
FROM public.subscriptions s
LEFT JOIN public.accounts a ON a.id = s.account_id
ORDER BY s.created_at DESC
LIMIT 1;
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü–ª–∞–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö `[Onboarding] Plan selected:` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `planId: ''` –∏–ª–∏ `undefined`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∑–∞–º—ã–∫–∞–Ω–∏–µ)

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `prev => ({ ...prev, ... })`

### –ü–ª–∞–Ω –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ API

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö `[CreateProject] Received request data:` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `planId: ''` –∏–ª–∏ `undefined`

**–ü—Ä–∏—á–∏–Ω–∞:** `onboardingData.planId` –ø—É—Å—Ç–æ–π –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `[Onboarding] Sending project creation request:` - —Ç–∞–º –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `planId: 'starter'` –∏–ª–∏ `'growth'`

### –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ API

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö `[CreateProject] Skipping subscription creation:` —Å –ø—Ä–∏—á–∏–Ω–æ–π `'No planId provided'`

**–ü—Ä–∏—á–∏–Ω–∞:** `planId` –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∏–ª–∏ –ø—É—Å—Ç–æ–π

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `planId` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å–µ

### –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö `[CreateProject] Error creating subscription:`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ RLS

**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `subscriptions` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏

## –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π

1. **–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Console**
2. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥:**
   - –†–µ–≥–∏–æ–Ω: Ukraine (UA)
   - –ü–ª–∞–Ω: Starter
   - –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥ `[StepPricing] Calling onPlanSelect`
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥ `[Onboarding] Plan selected`
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥ `[Onboarding] Sending project creation request` —Å `planId: 'starter'`

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:**
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥ `[CreateProject] Received request data` —Å `planId: 'starter'`
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥ `[CreateProject] ‚úÖ Created pending subscription`

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/users`
   - –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –î–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø–ª–∞–Ω "Starter"

## –ì–æ—Ç–æ–≤–æ! üéâ

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è. –¢–µ–ø–µ—Ä—å –ø–ª–∞–Ω –¥–æ–ª–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –≤ API.



